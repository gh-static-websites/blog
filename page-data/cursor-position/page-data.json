{"componentChunkName":"component---src-templates-post-tsx","path":"/cursor-position/","result":{"data":{"site":{"siteMetadata":{"title":"Qhan"}},"markdownRemark":{"id":"9ae37095-3590-5b6e-80b8-9f17f3cfc51d","excerpt":"在应用中某些场景下，我们会涉及到对表单元素与或者是带有属性的元素，设置自动获取焦点。在这些元素没有内容的情况下那么设置焦点非常容易，然而现实情况往往总是与众不同。那么在遇到这些需求我们该如何做呢？ Input&TextArea Contenteditable","html":"<p>在应用中某些场景下，我们会涉及到对表单元素<code class=\"language-text\">input</code>与<code class=\"language-text\">textarea</code>或者是带有属性<code class=\"language-text\">contenteditable=\"true\"</code>的元素，设置自动获取焦点。在这些元素没有内容的情况下那么设置焦点非常容易，然而现实情况往往总是与众不同。那么在遇到这些需求我们该如何做呢？</p>\n<h3>Input&#x26;TextArea</h3>\n<h3>Contenteditable</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">placeCaretAtEnd</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  el<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">typeof</span> window<span class=\"token punctuation\">.</span>getSelection <span class=\"token operator\">!=</span> <span class=\"token string\">\"undefined\"</span> <span class=\"token operator\">&amp;&amp;</span>\n    <span class=\"token keyword\">typeof</span> document<span class=\"token punctuation\">.</span>createRange <span class=\"token operator\">!=</span> <span class=\"token string\">\"undefined\"</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> range <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createRange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    range<span class=\"token punctuation\">.</span><span class=\"token function\">selectNodeContents</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    range<span class=\"token punctuation\">.</span><span class=\"token function\">collapse</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> sel <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">getSelection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    sel<span class=\"token punctuation\">.</span><span class=\"token function\">removeAllRanges</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    sel<span class=\"token punctuation\">.</span><span class=\"token function\">addRange</span><span class=\"token punctuation\">(</span>range<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>createTextRange <span class=\"token operator\">!=</span> <span class=\"token string\">\"undefined\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> textRange <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">createTextRange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    textRange<span class=\"token punctuation\">.</span><span class=\"token function\">moveToElementText</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    textRange<span class=\"token punctuation\">.</span><span class=\"token function\">collapse</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    textRange<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 调用方式</span>\n<span class=\"token function\">placeCaretAtEnd</span><span class=\"token punctuation\">(</span>review<span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".textarea\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"title":"文本域光标定位","date":"June 10, 2018","description":null}},"previous":{"fields":{"slug":"/react-component-lifecycle/"},"frontmatter":{"title":"React 组件生命周期"}},"next":{"fields":{"slug":"/thumbnail-generator/"},"frontmatter":{"title":"利用CANVAS生成缩略图"}}},"pageContext":{"id":"9ae37095-3590-5b6e-80b8-9f17f3cfc51d","previousPostId":"68502b3a-c30f-5e80-abcf-1a5512901207","nextPostId":"0c971d77-1195-5d9b-be83-60feb74f1459"}},"staticQueryHashes":["2841359383","3159585216"],"slicesMap":{}}