{"componentChunkName":"component---src-templates-post-tsx","path":"/dnd-kit-ant-table/","result":{"data":{"site":{"siteMetadata":{"title":"Qhan"}},"markdownRemark":{"id":"1ff05058-4800-5266-b857-c22e505f84a5","excerpt":"背景 最近业务需求上要求对表格加入拖拽排序功能，由于我们UI组件库基于antd，根据组件库官方文档给出的基于react-dnd、react-sortable-hoc示例，与我们自身业务需求的调研，最后选择react-sortable-hoc…","html":"<h3>背景</h3>\n<p>最近业务需求上要求对表格加入拖拽排序功能，由于我们UI组件库基于<a href=\"https://ant.design/\">antd</a>，根据组件库官方文档给出的基于<a href=\"https://github.com/react-dnd/react-dnd\">react-dnd</a>、<a href=\"https://github.com/clauderic/react-sortable-hoc\">react-sortable-hoc</a>示例，与我们自身业务需求的调研，最后选择<a href=\"https://github.com/clauderic/react-sortable-hoc\">react-sortable-hoc</a>库作为接入拖拽排序接入。在查阅该库相关文档的过程中其作者明确定不再积极维护，并强烈建议采用<a href=\"https://github.com/clauderic/dnd-kit\">dnd-kit</a>替换。本着<del>学习的态度</del>一步到位想法（偷懒)，因此最终决定直接使用<a href=\"https://github.com/clauderic/dnd-kit\">dnd-kit</a>库来实现拖拽排序功能。</p>\n<h3>如何使用</h3>\n<p>要了解如何开始使用<strong>dnd kit</strong>，请访问<a href=\"https://dndkit.com/\">官方文档</a>网站。您会找到深入的 API 文档、提示和指南，以帮助您构建拖放界面。在本文档中，我们只针对<strong>antd</strong>的<strong>table</strong>组件如何成功接入<strong>dnd-kit</strong>排序功能说明。本文档也不会对各类拖拽组件作对比说明，若有需要请参阅: <a href=\"https://zhuanlan.zhihu.com/p/430177180\">React拖拽排序组件库对比研究</a>。</p>\n<h3>开始</h3>\n<blockquote>\n<p>dnd-kit 预置了专用于排序操作的sortable组件，因此接下来我们也仅针对antd table组件排序方面的流程做 详细说明。在这里我们也认为你当前环境已经基于antd的开发环境</p>\n</blockquote>\n<p>首先，我们需要先安装<strong>dnd-kit</strong>相关依赖</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">pnpm</span> <span class=\"token function\">add</span> @dnd-kit/core @dnd-kit/sortable @dnd-kit/modifiers</code></pre></div>\n<p>2、创建一个名为<code class=\"language-text\">DndKitSortable.tsx</code>的文件，并编写基本的表格数据模板，表格需要关闭分页功能，因为拖拽排序不支持跨页。</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> DragOutlined <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@ant-design/icons'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Table <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'antd'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">type</span> <span class=\"token punctuation\">{</span> TableColumnProps <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'antd'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'孔艳'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'女'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'江艳'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'男'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'姚娜'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'女'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'4'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'何洋'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">77</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'女'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'5'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'卢静'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'男'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TableItem</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  name<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  sex<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  age<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  address<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>dataSource<span class=\"token punctuation\">,</span> setDataSource<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">useState</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> columns<span class=\"token operator\">:</span> TableColumnProps<span class=\"token operator\">&lt;</span>TableItem<span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      title<span class=\"token operator\">:</span> <span class=\"token string\">'排序'</span><span class=\"token punctuation\">,</span>\n      dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'sort'</span><span class=\"token punctuation\">,</span>\n      width<span class=\"token operator\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">render</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DragOutlined</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n      align<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> title<span class=\"token operator\">:</span> <span class=\"token string\">'姓名'</span><span class=\"token punctuation\">,</span> dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'name'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> title<span class=\"token operator\">:</span> <span class=\"token string\">'性别'</span><span class=\"token punctuation\">,</span> dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'sex'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> title<span class=\"token operator\">:</span> <span class=\"token string\">'年龄'</span><span class=\"token punctuation\">,</span> dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'age'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> title<span class=\"token operator\">:</span> <span class=\"token string\">'地址'</span><span class=\"token punctuation\">,</span> dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'address'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Table</span></span> <span class=\"token attr-name\">rowKey</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>id<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dataSource</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>dataSource<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">columns</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>columns<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">pagination</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>3、在文件<code class=\"language-text\">SortableItem.tsx</code>中引入<strong>dnd-kit</strong>相关依赖，并用组件<code class=\"language-text\">DndContext</code>与<code class=\"language-text\">SortableContext</code> 包裹<code class=\"language-text\">Table</code>组件</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">...\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> import { DndContext } from '@dnd-kit/core';\n<span class=\"token prefix inserted\">+</span> import { SortableContext } from '@dnd-kit/sortable';\n</span>...\n\nexport default () => {\n...\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> return (\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;DndContext>\n<span class=\"token prefix inserted\">+</span>      &lt;SortableContext items={[]}>\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>       &lt;Table rowKey=\"id\" dataSource={dataSource} columns={columns} pagination={false} />\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>      &lt;/SortableContext>\n<span class=\"token prefix inserted\">+</span>    &lt;/DndContext>\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> );\n</span>};</code></pre></div>\n<p>4、定义拖拽排序方向，及拖拽strategy策略。</p>\n<p>在顶层组件<code class=\"language-text\">DndContext</code>中您可以定义拖拽的修饰方式。在本示例中我们将采用<code class=\"language-text\">restrictToVerticalAxis</code>修饰方式来限制拖拽排序保持在垂直方向。当然在其它场景中您也可以配置为水平方向。<code class=\"language-text\">DndContext</code>组件也内置了一些其修饰方式：</p>\n<ul>\n<li><code class=\"language-text\">restrictToHorizontalAxis</code>：将移动限制在水平轴上。</li>\n<li><code class=\"language-text\">restrictToVerticalAxis</code>：将移动限制在垂直轴上。</li>\n<li><code class=\"language-text\">restrictToWindowEdges</code>：限制移动到窗口的边缘。防止将元素移出窗口边界。</li>\n</ul>\n<p>更多修饰方式请查阅：<a href=\"https://docs.dndkit.com/api-documentation/modifiers\">dnd-kit修饰符</a></p>\n<p><code class=\"language-text\">SortableContext</code>组件要求您将唯一标识符的排序数组传递给它，这些唯一标识符与在其中使用<code class=\"language-text\">useSortable</code>的元素相关联。即下面所定义<code class=\"language-text\">SortableItem.tsx</code>组件中<code class=\"language-text\">useSortable</code>的配置<code class=\"language-text\">id</code>。</p>\n<p><code class=\"language-text\">SortableContext</code>组件接受不同的排序策略来计算<code class=\"language-text\">useSortable</code>转换。内置策略包括：</p>\n<ul>\n<li><code class=\"language-text\">rectSortingStrategy</code>：默认值，适用于大多数用例。不支持虚拟化列表。</li>\n<li><code class=\"language-text\">verticalListSortingStrategy</code>：此策略针对垂直列表进行了优化，并支持虚拟化列表。</li>\n<li><code class=\"language-text\">horizontalListSortingStrategy</code>：此策略针对水平列表进行了优化，并支持虚拟化列表。</li>\n<li><code class=\"language-text\">rectSwappingStrategy</code>：使用此策略实现可交换功能。</li>\n</ul>\n<p>在本示例中我们做垂直方向拖拽排序，因此我们使用<code class=\"language-text\">verticalListSortingStrategy</code>排序策略。</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">...\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> import { SortableContext, verticalListSortingStrategy } from '@dnd-kit/sortable';\n<span class=\"token prefix inserted\">+</span> import { restrictToVerticalAxis } from '@dnd-kit/modifiers';\n</span>...\nexport default () => {\n...\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> return (\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;DndContext modifiers={[restrictToVerticalAxis]}>\n<span class=\"token prefix inserted\">+</span>      &lt;SortableContext items={dataSource.map((c) => c.id)} strategy={verticalListSortingStrategy}>\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>       &lt;Table rowKey=\"id\" dataSource={dataSource} columns={columns} pagination={false} />\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>      &lt;/SortableContext>\n<span class=\"token prefix inserted\">+</span>    &lt;/DndContext>\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> );\n</span>};</code></pre></div>\n<p>到此时，我们已经定义排序的最基本配置，接下来才是真正的对<code class=\"language-text\">Table</code>组件改造。首先我们需要使用<code class=\"language-text\">Table</code>组件的<code class=\"language-text\">components</code>属性对表格行元素进行重写。</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">...\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>  &lt;Table rowKey=\"id\" dataSource={dataSource} columns={columns} pagination={false} components={{ body: { row: SortableItem } }}/>\n</span>...</code></pre></div>\n<blockquote>\n<p><code class=\"language-text\">Table</code>组件的<code class=\"language-text\">components</code>的详细说明，请查看文档：<a href=\"https://ant.design/components/table-cn/#API\">https://ant.design/components/table-cn/#API</a></p>\n</blockquote>\n<p>此时，我们的程序会提示找不到<strong>SortableItem</strong>，是因为我们还未编写该组件，接下来我们将开始自定义表格行元素。</p>\n<p>5、重写<code class=\"language-text\">Table</code>组件行元素，新建组件<code class=\"language-text\">SortableItem.tsx</code>, 并编写程序</p>\n<p>在此处我们需要通过<code class=\"language-text\">useSortable</code>与列表元素的唯一标识符来建立绑定关系，在此处我们采用的是<code class=\"language-text\">Table</code>表格行元素内置属性<code class=\"language-text\">data-row-key</code>（即数据ID）来建立关系，即先取出<code class=\"language-text\">data-row-key</code>值，并分别传递给<code class=\"language-text\">useSortable</code>以及<code class=\"language-text\">tr</code>标签的<code class=\"language-text\">id</code>属性。</p>\n<p>通过<code class=\"language-text\">useSortable</code>可以得到<code class=\"language-text\">attributes</code>, <code class=\"language-text\">listeners</code>, <code class=\"language-text\">setNodeRef</code>三个值，在这里，我们将这个值一并赋给<code class=\"language-text\">tr</code>标签。</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useSortable <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@dnd-kit/sortable'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">SortableItem</span><span class=\"token punctuation\">(</span>props<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> props<span class=\"token punctuation\">[</span><span class=\"token string\">'data-row-key'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> attributes<span class=\"token punctuation\">,</span> listeners<span class=\"token punctuation\">,</span> setNodeRef <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSortable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> id <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span> <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>setNodeRef<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>attributes<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>listeners<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">data-cypress</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>draggable-item<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>6、添加拖动交互事件</p>\n<p>为<code class=\"language-text\">DndContext</code>组件添加拖拽方法，在这里我们使用<code class=\"language-text\">onDragEnd</code>即可。同时需要用到<code class=\"language-text\">sortable</code>提供的<code class=\"language-text\">arrayMove</code>方法来处理排序后生成新的数据。到此时一个正常的基于<strong>dnd-kit</strong>可以拖动排序的antd表格就实现啦。</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">...\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> import type { DragEndEvent } from '@dnd-kit/core';\n<span class=\"token prefix inserted\">+</span> import { arrayMove, SortableContext, verticalListSortingStrategy } from '@dnd-kit/sortable';\n</span>...\n\nexport default () => {\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>  const handleDragEnd = (event: DragEndEvent) => {\n<span class=\"token prefix inserted\">+</span>    const { active, over } = event;\n<span class=\"token prefix inserted\">+</span>    if (active.id !== over?.id) {\n<span class=\"token prefix inserted\">+</span>      const oldIndex = dataSource.findIndex((item) => item.id === active.id);\n<span class=\"token prefix inserted\">+</span>      const newIndex = dataSource.findIndex((item) => item.id === over?.id);\n<span class=\"token prefix inserted\">+</span>      const next = arrayMove(dataSource, oldIndex, newIndex);\n<span class=\"token prefix inserted\">+</span>      setDataSource(next);\n<span class=\"token prefix inserted\">+</span>    }\n<span class=\"token prefix inserted\">+</span>  };\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> return (\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    &lt;DndContext modifiers={[restrictToVerticalAxis]} onDragEnd={handleDragEnd}>\n</span>...\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>   &lt;/DndContext>\n<span class=\"token prefix unchanged\"> </span> );\n</span>};\n</code></pre></div>\n<p>7、为排序添加交互样式</p>\n<p>在上一步，我们仅实现了基本的排序操作，在视觉上看着不是那么的丝滑，让我们为它添加一些视觉交互吧。</p>\n<p>首先，通过<code class=\"language-text\">useSortable</code>得到<code class=\"language-text\">transform</code>, <code class=\"language-text\">transition</code>, <code class=\"language-text\">isDragging</code>三个属性。定义拖动样式。并为<code class=\"language-text\">tr</code>无素添加样式类。</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useSortable <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@dnd-kit/sortable'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./styles.less'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">SortableItem</span><span class=\"token punctuation\">(</span>props<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> props<span class=\"token punctuation\">[</span><span class=\"token string\">'data-row-key'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> attributes<span class=\"token punctuation\">,</span> listeners<span class=\"token punctuation\">,</span> setNodeRef<span class=\"token punctuation\">,</span> transform<span class=\"token punctuation\">,</span> transition<span class=\"token punctuation\">,</span> isDragging <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSortable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    id<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> dragStyle <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    transition<span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// transform: CSS.Translate.toString(transform),</span>\n    <span class=\"token string-property property\">'--translate-x'</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>transform<span class=\"token operator\">?.</span>x <span class=\"token operator\">??</span> <span class=\"token number\">0</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">'--translate-y'</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>transform<span class=\"token operator\">?.</span>y <span class=\"token operator\">??</span> <span class=\"token number\">0</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> style<span class=\"token punctuation\">,</span> className<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>rest <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> cls <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>className<span class=\"token punctuation\">,</span> <span class=\"token string\">'dragItem'</span><span class=\"token punctuation\">,</span> isDragging <span class=\"token operator\">?</span> <span class=\"token string\">'dragOverlay'</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span>\n      <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">[</span><span class=\"token string\">'data-row-key'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>setNodeRef<span class=\"token punctuation\">}</span></span>\n      <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>attributes<span class=\"token punctuation\">}</span></span>\n      <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>listeners<span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>cls<span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>style<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>dragStyle <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>rest<span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">data-cypress</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>draggable-item<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>新建<code class=\"language-text\">styles.scss</code>并编拖拽的交互样式。</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token atrule\"><span class=\"token rule\">@keyframes</span> pop</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">0% </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-x<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-y<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span>1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--box-shadow-picked-up<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">100% </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-x<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-y<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--scale<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--box-shadow-picked-up<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 元素拖动样式</span>\n<span class=\"token selector\">.dragItem </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">touch-action</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-x<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-y<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--scale<span class=\"token punctuation\">,</span> 1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> box-shadow 200ms ease<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.dragOverlay </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--scale</span><span class=\"token punctuation\">:</span> 1.02<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--box-shadow-picked-up</span><span class=\"token punctuation\">:</span> 0 0 0 <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>1px <span class=\"token operator\">/</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--scale-x<span class=\"token punctuation\">,</span> 1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>63<span class=\"token punctuation\">,</span> 63<span class=\"token punctuation\">,</span> 68<span class=\"token punctuation\">,</span> 0.05<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    -1px 0 15px 0 <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>34<span class=\"token punctuation\">,</span> 33<span class=\"token punctuation\">,</span> 81<span class=\"token punctuation\">,</span> 0.01<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 0px 15px 15px 0 <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>34<span class=\"token punctuation\">,</span> 33<span class=\"token punctuation\">,</span> 81<span class=\"token punctuation\">,</span> 0.25<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token property\">animation</span><span class=\"token punctuation\">:</span> pop 200ms <span class=\"token function\">cubic-bezier</span><span class=\"token punctuation\">(</span>0.18<span class=\"token punctuation\">,</span> 0.67<span class=\"token punctuation\">,</span> 0.6<span class=\"token punctuation\">,</span> 1.22<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--box-shadow-picked-up<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">z-index</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 禁止表格单无格元素的一些默认行为</span>\n  <span class=\"token selector\">> td </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">border-color</span><span class=\"token punctuation\">:</span> transparent <span class=\"token important\">!important</span><span class=\"token punctuation\">;</span>\n    <span class=\"token selector\">> span </span><span class=\"token punctuation\">{</span>\n      <span class=\"token property\">pointer-events</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>8、定义表格拖拽把手</p>\n<p>现在我们表格拖拽时是针对表格的整行操作，很多时候我们其实希望通过点击表格单元格的拖拽按钮进行排序。我们再对<code class=\"language-text\">SortableItem.tsx</code>组件进行改造一下。</p>\n<p>找出表格<code class=\"language-text\">columns</code>定义时，排序按钮所在列的单元格（通过定义的<code class=\"language-text\">key</code>值，本示例中<code class=\"language-text\">key</code>为<code class=\"language-text\">sort</code>），对该单元格绑定监听，即将<code class=\"language-text\">listeners</code>绑定到该单元格。在这里最重要的知识点是对<code class=\"language-text\">react</code>的<code class=\"language-text\">children</code>元素赋予额外属性，需要用到两个react原生API：<code class=\"language-text\">React.Children</code>、<code class=\"language-text\">React.cloneElement</code></p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> import React from 'react';\n</span>...\nexport function SortableItem(props: any) {\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>  const { style, className, children, ...rest } = props;\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> return (\n<span class=\"token prefix unchanged\"> </span>   &lt;tr\n<span class=\"token prefix unchanged\"> </span>     id={props['data-row-key']}\n<span class=\"token prefix unchanged\"> </span>     ref={setNodeRef}\n<span class=\"token prefix unchanged\"> </span>     {...attributes}\n</span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span>     {...listeners}\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>     className={cls}\n<span class=\"token prefix unchanged\"> </span>     style={{ ...style, ...dragStyle }}\n<span class=\"token prefix unchanged\"> </span>     {...rest}\n<span class=\"token prefix unchanged\"> </span>     data-cypress=\"draggable-item\"\n<span class=\"token prefix unchanged\"> </span>   >\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>      {React.Children.map(children, (child) => {\n<span class=\"token prefix inserted\">+</span>        if (child.key === 'sort') {\n<span class=\"token prefix inserted\">+</span>          return React.cloneElement(child, {\n<span class=\"token prefix inserted\">+</span>            additionalProps: { ...listeners, 'data-cypress': 'draggable-handle' },\n<span class=\"token prefix inserted\">+</span>          });\n<span class=\"token prefix inserted\">+</span>        }\n</span>\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>        return child;\n<span class=\"token prefix inserted\">+</span>      })}\n<span class=\"token prefix inserted\">+</span>    &lt;/tr>\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> );\n</span>}</code></pre></div>\n<p>到此处，一个完整的丝滑的基于<strong>dnd-kit</strong>的antd表格组件排序就完成啦！～～～撒花</p>\n<h3>完整代码</h3>\n<p><code class=\"language-text\">DndKitTable.tsx</code></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> DragOutlined <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@ant-design/icons'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Table <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'antd'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">type</span> <span class=\"token punctuation\">{</span> TableColumnProps <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'antd'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> DndContext <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@dnd-kit/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">type</span> <span class=\"token punctuation\">{</span> DragEndEvent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@dnd-kit/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> arrayMove<span class=\"token punctuation\">,</span> SortableContext<span class=\"token punctuation\">,</span> verticalListSortingStrategy <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@dnd-kit/sortable'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> restrictToVerticalAxis <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@dnd-kit/modifiers'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> SortableItem <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./SortableItem'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./styles.scss'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'孔艳'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">33</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'女'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'江艳'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'男'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'姚娜'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'女'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'4'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'何洋'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">77</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'女'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'5'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'卢静'</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> sex<span class=\"token operator\">:</span> <span class=\"token string\">'男'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TableItem</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  name<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  sex<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  age<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  address<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>dataSource<span class=\"token punctuation\">,</span> setDataSource<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">useState</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> columns<span class=\"token operator\">:</span> TableColumnProps<span class=\"token operator\">&lt;</span>TableItem<span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      title<span class=\"token operator\">:</span> <span class=\"token string\">'排序'</span><span class=\"token punctuation\">,</span>\n      dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'sort'</span><span class=\"token punctuation\">,</span>\n      width<span class=\"token operator\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">render</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DragOutlined</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n      align<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> title<span class=\"token operator\">:</span> <span class=\"token string\">'姓名'</span><span class=\"token punctuation\">,</span> dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'name'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> title<span class=\"token operator\">:</span> <span class=\"token string\">'性别'</span><span class=\"token punctuation\">,</span> dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'sex'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> title<span class=\"token operator\">:</span> <span class=\"token string\">'年龄'</span><span class=\"token punctuation\">,</span> dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'age'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> title<span class=\"token operator\">:</span> <span class=\"token string\">'地址'</span><span class=\"token punctuation\">,</span> dataIndex<span class=\"token operator\">:</span> <span class=\"token string\">'address'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleDragEnd</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>event<span class=\"token operator\">:</span> DragEndEvent<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> active<span class=\"token punctuation\">,</span> over <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>active<span class=\"token punctuation\">.</span>id <span class=\"token operator\">!==</span> over<span class=\"token operator\">?.</span>id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> oldIndex <span class=\"token operator\">=</span> dataSource<span class=\"token punctuation\">.</span><span class=\"token function\">findIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> active<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> newIndex <span class=\"token operator\">=</span> dataSource<span class=\"token punctuation\">.</span><span class=\"token function\">findIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> over<span class=\"token operator\">?.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">const</span> next <span class=\"token operator\">=</span> <span class=\"token function\">arrayMove</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">,</span> oldIndex<span class=\"token punctuation\">,</span> newIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token function\">setDataSource</span><span class=\"token punctuation\">(</span>next<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DndContext</span></span> <span class=\"token attr-name\">modifiers</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">[</span>restrictToVerticalAxis<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onDragEnd</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleDragEnd<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SortableContext</span></span> <span class=\"token attr-name\">items</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>dataSource<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">strategy</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>verticalListSortingStrategy<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Table</span></span>\n          <span class=\"token attr-name\">rowKey</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>id<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dnd<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">dataSource</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>dataSource<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">columns</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>columns<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">pagination</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">components</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> body<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> row<span class=\"token operator\">:</span> SortableItem <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n        <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">SortableContext</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">DndContext</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">SortableItem.tsx</code></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useSortable <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@dnd-kit/sortable'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./styles.scss'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">SortableItem</span><span class=\"token punctuation\">(</span>props<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> props<span class=\"token punctuation\">[</span><span class=\"token string\">'data-row-key'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> attributes<span class=\"token punctuation\">,</span> listeners<span class=\"token punctuation\">,</span> setNodeRef<span class=\"token punctuation\">,</span> transform<span class=\"token punctuation\">,</span> transition<span class=\"token punctuation\">,</span> isDragging <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSortable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    id<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> dragStyle <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    transition<span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// transform: CSS.Translate.toString(transform),</span>\n    <span class=\"token string-property property\">'--translate-x'</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>transform<span class=\"token operator\">?.</span>x <span class=\"token operator\">??</span> <span class=\"token number\">0</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">'--translate-y'</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>transform<span class=\"token operator\">?.</span>y <span class=\"token operator\">??</span> <span class=\"token number\">0</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> style<span class=\"token punctuation\">,</span> className<span class=\"token punctuation\">,</span> children<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>rest <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> cls <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>className<span class=\"token punctuation\">,</span> <span class=\"token string\">'dragItem'</span><span class=\"token punctuation\">,</span> isDragging <span class=\"token operator\">?</span> <span class=\"token string\">'dragOverlay'</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span>\n      <span class=\"token attr-name\">id</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>setNodeRef<span class=\"token punctuation\">}</span></span>\n      <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>attributes<span class=\"token punctuation\">}</span></span>\n      <span class=\"token comment\">// {...listeners}</span>\n      <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>cls<span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>style<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>dragStyle <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>rest<span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">data-cypress</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>draggable-item<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>React<span class=\"token punctuation\">.</span>Children<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>children<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>key <span class=\"token operator\">===</span> <span class=\"token string\">'sort'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">cloneElement</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n            additionalProps<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>listeners<span class=\"token punctuation\">,</span> <span class=\"token string-property property\">'data-cypress'</span><span class=\"token operator\">:</span> <span class=\"token string\">'draggable-handle'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> child<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">styles.scss</code></p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token atrule\"><span class=\"token rule\">@keyframes</span> pop</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">0% </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-x<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-y<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span>1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--box-shadow-picked-up<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">100% </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-x<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-y<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--scale<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--box-shadow-picked-up<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.dnd </span><span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">.ant-table-tbody td[data-cypress='draggable-handle'] </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">cursor</span><span class=\"token punctuation\">:</span> pointer<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 元素拖动样式</span>\n<span class=\"token selector\">.dragItem </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">touch-action</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-x<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate-y<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">)</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--scale<span class=\"token punctuation\">,</span> 1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> box-shadow 200ms ease<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.dragOverlay </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--scale</span><span class=\"token punctuation\">:</span> 1.02<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--box-shadow-picked-up</span><span class=\"token punctuation\">:</span> 0 0 0 <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>1px <span class=\"token operator\">/</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--scale-x<span class=\"token punctuation\">,</span> 1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>63<span class=\"token punctuation\">,</span> 63<span class=\"token punctuation\">,</span> 68<span class=\"token punctuation\">,</span> 0.05<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    -1px 0 15px 0 <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>34<span class=\"token punctuation\">,</span> 33<span class=\"token punctuation\">,</span> 81<span class=\"token punctuation\">,</span> 0.01<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 0px 15px 15px 0 <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>34<span class=\"token punctuation\">,</span> 33<span class=\"token punctuation\">,</span> 81<span class=\"token punctuation\">,</span> 0.25<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token property\">animation</span><span class=\"token punctuation\">:</span> pop 200ms <span class=\"token function\">cubic-bezier</span><span class=\"token punctuation\">(</span>0.18<span class=\"token punctuation\">,</span> 0.67<span class=\"token punctuation\">,</span> 0.6<span class=\"token punctuation\">,</span> 1.22<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--box-shadow-picked-up<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">z-index</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 禁用单元格元素默认行为</span>\n  <span class=\"token selector\">> td </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">border-color</span><span class=\"token punctuation\">:</span> transparent <span class=\"token important\">!important</span><span class=\"token punctuation\">;</span>\n    <span class=\"token selector\">> span </span><span class=\"token punctuation\">{</span>\n      <span class=\"token property\">pointer-events</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h3>参考</h3>\n<ul>\n<li><a href=\"https://docs.dndkit.com/presets/sortable/sortable-context\">dnd-kit sortable</a></li>\n<li><a href=\"https://ant.design/components/table-cn/#components-table-demo-drag-sorting-handler\">Antd Table 拖拽手柄列</a></li>\n<li><a href=\"https://master--5fc05e08a4a65d0021ae0bf2.chromatic.com/?path=/story/presets-sortable-vertical--drag-handle&#x26;globals=backgrounds.grid:false\">dnd-kit示例</a></li>\n</ul>","frontmatter":{"title":"基于dnd-kit实现Antd Table组件拖拽排序","date":"November 05, 2022","description":null}},"previous":null,"next":{"fields":{"slug":"/react-component-lifecycle/"},"frontmatter":{"title":"React 组件生命周期"}}},"pageContext":{"id":"1ff05058-4800-5266-b857-c22e505f84a5","previousPostId":null,"nextPostId":"68502b3a-c30f-5e80-abcf-1a5512901207"}},"staticQueryHashes":["2841359383","3159585216"],"slicesMap":{}}